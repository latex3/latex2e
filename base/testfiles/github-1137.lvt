
\ExplSyntaxOn
\debug_on:n { check-declarations , deprecation }
\ExplSyntaxOff

\input{regression-test}

\documentclass{article}

\START

\ExplSyntaxOn
\sys_if_engine_luatex:F { \endinput }
\ExplSyntaxOff

\AddToHook{package/a/before}
  {\halign{a#&b#\cr 1&2\cr 1&2\cr}} % works

\AddToHook{package/b/before}
  {\halign{a\alignmark&b\alignmark\cr 1&2\cr 1&2\cr}} % errors

\AddToHook{package/c/before}
  {\halign{a\alignmark\alignmark&b\alignmark\alignmark\cr 1&2\cr 1&2\cr}}

\NewHook{test}
\AddToHook{test}
  {\halign{a\alignmark&b\alignmark\cr 1&2\cr 1&2\cr}}

\begin{document}

\UseHook{test}

\END
