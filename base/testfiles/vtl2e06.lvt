% Document Type: LaTeX
% Master File: tlatex6.tex
% \iffalse meta-comment
%
% Copyright (C) 1992 by David Carlisle, Frank Mittelbach.  
% All rights reserved.
% 
% This file is part of the validate package.
% 
% IMPORTANT NOTICE:
% 
% You are not allowed to change this file.  In case of error
% write to the email address mentioned in the file readme.val.
% 
% \fi
%
% Test file for latex.tex containing checks for the bug fixes
% 71-72-74-78-81-82-85-86-87-88-90-91-93-98-101-103-105-107-108-110-112
% from latex.bug

\input{test2e}

\AUTHOR{Daniel FLIPO}
\ADDRESS{flipo@alea.citilille.fr}

\FORMAT{LaTeX2e<1993/12/24>}

\CLASS{book}


\newbox\test

\newcommand{\bugid}[1]{\typeout{}
                       \typeout{*** Bug #1 ***}
                       \typeout{}*** #1 ***\par}

\documentclass{book}

\begin{document}
\nonstopmode\tracingonline1

\START

%71. A sectioning command (like \paragraph) that produces an in-line
%heading (not on a separate line) doesn't work properly when it is
%immediately followed by a list or trivlist environment, or one that
%uses those environments (like verbatim or quote).  (Corrected in Version
%2.09.)
%

\showoutput

\chapter{First chapter}

\bugid{71}

\section{First section}

\paragraph{First paragragh}%
\begin{itemize}
  \item What's wrong with paragraphs and lists?
  \item apparently nothing!
\end{itemize}

%74. \longrightarrow and \longleftarrow need \protect'ing in a moving
%argument.  (Corrected 4 September 85)
%

\bugid{74}

\section{Do $\longrightarrow$ and $\longleftarrow$ or $\longleftrightarrow$
need protect'ing?} 


%75. In certain instances, the not enough vertical space appears
%above a list environment.  (Corrected 4 September 85)
%
%76. The \textfraction parameter was being ignored, and a random
%value used.  (Corrected 27 September 85)
%
%77. The \item command was changed to allow a line break between
%the label and the following text.  This makes it easier to define
%a list environment in which the item occurs on a line by itself.
%(Change made 3 October 85).
%
%78. No warning was generated by the eqnarray and eqnarray* environments
%when a formula extended into the margin.  (Corrected 4 November 85.
%However, warning is not generated if formula extends only into the
%equation number.)
%

\vspace{10mm}

\bugid{78}

% warning is NOT generated if formula extends only into the
% equation number
\begin{eqnarray}
	U_n &= &a_0 b_n + a_1 b_{n-1} + \cdots + a_{n-1} b_1 + a_n b_0
+ c_0 d_n + \cdots + c_0 d_n + V_{n-1} \\
    V_n &= &a_0 c_n + a_1 c_{n-1} + \cdots + a_{n-1} c_1 + a_n c_0
\end{eqnarray}

% warning IS generated!
\begin{eqnarray*}
	U_n &= &a_0 b_n + a_1 b_{n-1} + \cdots + a_{n-1} b_1 + a_n b_0
+ c_0 d_n + \cdots + c_0 d_n + \int_0^\infty \frac{R_n(t)}{1+t^2}\, dt \\
    V_n &= &a_0 c_n + a_1 c_{n-1} + \cdots + a_{n-1} c_1 + a_n c_0
\end{eqnarray*}


%72. Full page figures or tables that immediately follow the first
%page of a chapter appear on pages with no page headings.  More
%generally, full page floats that immediately follow a page
%with a \thispagestyle{foo} command are formatted according to
%page style foo.  (Corrected in Version 2.09.)
%

%\bugid{72}

\begin{figure}[htb]
 \framebox[100mm]{\rule{0mm}{150mm}}
 \caption{*** Bug 72 ***}
\end{figure}

\clearpage %%%% whithout this clearpage the figure is moved to page 3, why?

%81. Space produced by \hspace* can be gobbled inside an array or
%tabular environment.   (Observed by Sam Whidden.)  (Corrected 17 December 85)
%

\bugid{81}

\begin{tabular}{|lcr|} \hline
Currency	&Amount			&Value in \$ \\ \hline
Pounds		&10				&18\\ \hline
DM			&3				&2\\ \hline
Total		&\hspace*{6cm}	&20\\ \hline
\end{tabular}

%82. \skewchar commands were omitted for the math italic and and math
%symbol fonts, causing improper placement of math accents.  (Observed
%by Howard Trickey)  (Corrected 17 December 85)
%

\bugid{82}

Math accents: $\widehat{xyz} \neq \widetilde{abc}$
$$\ddot x + \dot x + \bar a x^3 = \tilde f(t)$$

%83. The preloaded typewriter fonts have had \hyphenchar redefined to
%-1 to prevent hyphenation with these fonts.  (Change made 17 December 85)
%
%84.  In rare circumstances, a bug in \@dottedtocline resulted in a page
%number appearing at the left of the line following the section
%heading in a table of contents entry.  (Corrected 7 January 86)
%
%85. As a result of change 83, the \- command doesn't work properly
%with the typewriter fonts.  (Reported by John DeTreville.
%Corrected 19 April 86.)
%

\bugid{85}

\newlength{\hyphenbox}
\settowidth{\hyphenbox}{\tt gnomon-}
\parbox{\hyphenbox}{\tt gnomon\-ly\dots}

%86. In verbatim mode, the sequences ?` and !` produce ligatures
%instead of the correct characters.  (Found by Gerard Huet.
%Corrected 19 April 86.)
%

\bugid{86}

\begin{verbatim}
?`What about the spanish signs? !`Correct indeed!
\end{verbatim}

%87.  The \vector and \line commands (through the \@svector and \@sline
%macros) only check if the vertical component of the slope exceeds the
%limit (4 or 6) for the command; the horizontal component is not
%checked.  Thus, \vector(2,5){5} gives an error message while
%\vector(5,2){5} produces incorrect results without any message.  Some
%arguments will reference a non-existent character in the line font.
%(Found by Joseph I. Pallas.  Corrected 19 April 86.)
%

\bugid{87}

\nonstopmode

\begin{picture}(100,50)
\setlength{\unitlength}{1mm}
\put(0,15){\vector(2,-5){5}}
\put(10,15){\vector(5,-2){5}}
\put(20,10){\line(7,-1){5}}
\end{picture}

%%%% Have a look at what happens in the following example:
%\begin{picture}(100,50)
%\setlength{\unitlength}{1mm}
%\put(20,10){\line(3,7){5}}
%\end{picture}
% Here is the corresponding log-file:
%! Bad \line or \vector argument.                          %%%% quite normal
%\@latexerr ...for immediate help.}\errmessage {#1}
%                                                  
%l.201 \put(20,10){\line(3,7){5}}
%                                
%Missing character: There is no ^^V in font line10!        %%%% OK, this is
                                    %%%% mentionned in the bug report, BUT:
%! TeX capacity exceeded, sorry [main memory size=262141]. %%%% <==== ???
%<argument> ...\@upordown \@clnht \copy \@linechar 
%                                                  \@tempa \advance \@clnht \..
%l.201 \put(20,10){\line(3,7){5}}

%88. \newenvironment doesn't work if there's a \par command in
%an argument.  (Corrected 19 April 86.)
%

\bugid{88}

\newenvironment{descit}[1]%
{\begin{quote}
{\em #1:\par}}{\end{quote}}

\begin{descit}{{\bf Important}\par Armadillos}
  This is a witty description of the armadillo.
\end{descit}

%89.  An obscure bug in \settowidth caused by a missing \relax.
%(Discovered by Oren Patashnik, corrected 24 March 86.)
%
%90.  A \markright or \markboth immediately after a sectioning command
%could allow a page break right after the section heading.
%(Discovered by Oren Patashnik, corrected 15 April 86.)
%

%%%% With \vspace{42mm} the section title is moved to next page
\vspace{41mm}

\bugid{90}

\pagestyle{myheadings}
\section{Third section}
\markboth{{\bf section\ \thesection}\hfil MY HEADINGS}{{\bf Section\ \thesection}\hfil MY HEADINGS}

Let's see if a page break occurs just before this line.

%91. The \arabic command (actually \@arabic) was changed so it
%will print nonpositive numbers.  (Suggested by Charles Kearney.
%Change made 29 April 86.)
%

\bugid{91}
\OMIT
\newcounter{mycount}
\setcounter{mycount}{-2}
\TIMO
\themycount

%92.  An implementation error causes LaTeX to run out of room on very
%long tabbing environments.  (Discovered by Kent McPherson.  Corrected
%17 Jun 86)
%
%94.  Unnecessary overfull boxes caused by descenders on last line of
%page.  Fixed by modifying the output routine \@makecol.  A temporary
%dimen is used to hold the depth of the output box, then it is unboxed,
%then we vskip minus the depth. (2 Sep 86)
%
%95.  Grouping was taken out of \@latexerr. (Suggested by John Hobby.)
%(2 Sep 86)
%
%96.  \makethmlabel was deleted.  Never used anyway.
%(Found by Mark Kent, 2 Sep 86).
%
%97.  \footheight may soon be deleted.  Never used.  Taken out of style
%files too.  (Found by Mark Kent, 2 Sep 86).
%
%98.  When a section heading does not indent the following paragraph, a
%\noindent caused a negative indentation--i.e., an outdent.  (Change,
%suggested by suggestion by Mario Wolczko, made 2 Sep 86)
%

\bugid{98}

\section {Fourth section}

\noindent Is th beginning of this section indented correctly?

%100. In rare instances, a figure can appear on the page preceding
%its environment, and a marginal note may appear on the wrong side.
%(Found by Oren Patashnik)
%
%101. The \verb command produces an error if it appears in math
%mode with a `_' in its argument.  (This is a bug in PLAIN.TEX
%corrected in LPLAIN.TEX on 13 Oct 86 and SPLAIN.TEX on 28 Oct 86.)
%

\bugid{101}

$$\mbox{The command\ }\verb|x_n|\mbox{\ should produce:\ } x_n$$

%103.  The mechanism to suppress the paragraph indentation of text
%immediately following a paragarph-making environment does not work if
%that environment is enclosed in braces or another environment.  In
%particular, it wouldn't work for environments like the ones defined
%in the examples on page 57 of the manual--e.g., when called
%by the `emphit' environment, the `itemize' environment is
%inside another environment. (Corrected 27 Oct 86)
%

\bugid{103}

%%%% BUG NOT CORRECTED in case of braces (without braces: no indentation)
{\begin{quote}
  This a dummy quotation.
\end{quote}}
Is the indentation suppressed? Unfortunately it is NOT! -- 32 years later it is!!!

\newenvironment{emphit}{\begin{itemize}\em}{\end{itemize}}

\begin{emphit}
\item This environment produces emphasized items.
\item It is defined in terms of \LaTeX{}'s {\tt itemize} environment.
\end{emphit}
Is the indentation suppressed? YES it is!

%93.  In rare instances, a footnote is placed on the page following the
%one in belongs on.  This happens only when a figure or table
%environment appears in the text immediately after the place where the
%page that should contain the footnote ends.  Until this is fixed, the
%problem can be made to go away by moving the figure or table
%environment a little further back or forward in the text.
%

%%%% With \vspace{78mm} the footnote and the calling line are moved to the
% next page
\vspace{77mm}

\bugid{93}
Let's try a footnote\footnote{Will this footnote be moved to the next page?} 
on a page's last line with a figure just after it.
\begin{figure}[htb]
 \framebox[100mm]{\rule{0mm}{50mm}}
 \caption{*** Bug 93 ***}
\end{figure}

%106.  An apparent typo put two copies of \@texttop at the top of a page
%instead of just one.  This did not seem to affect any of the standard
%styles, but would have created problems in special styles that used
%\@texttop. (Reported by Michael Harrison, corrected 1 Dec 86.)
%
%107. An array environment in the third argument to a \multicolumn
%command did not work.  (Reported by Ferdinand Hommes, corrected 6 Dec 86.)
%

\bugid{107}

\vspace{2cm}

\begin{tabular}{lll}
 column 1 &column 2 & column 3\\
 array:   &\multicolumn{2}{c}{%
$\begin{array}{rrr}
 1 &2  &3\\
-3 &-2 &-1
\end{array}$} 
\end{tabular}


%110.  A \label or \index command in a section heading caused a bug
%if that heading was used as a page heading.  (Discovered by
%Tim Hopkins.  Corrected 22 Feb 87)
%
%112. \{ and \} are fragile commands, contrary to the manual.
%(Discovered by Piet van Oostrum <mcvax!ruuinfvax!piet@seismo.CSS.GOV>.
%Corrected 21 Apr 87.)
%

\bugid{110--112}

\pagestyle{headings}
\section{Are `\{' and `\}' fragile?\label{last:section}}

Is the use of a \verb|\label| command safe in a section title?

%108.  A long descender (such as is normally produced only by math
%formulas) on the bottom line of a page could extend lower than
%it should.  (Corrected 21 Jan 86)
%

%%%% With \vspace{26mm} the fraction is moved to next page
\vspace{25mm}

\bugid{108}

$$x=x_0 + {1 \over\displaystyle x_1 + {\strut 1 \over\displaystyle x_2 +
{\strut 1 \over\displaystyle x_3}}}$$

%111.  Setting \topskip to 0pt does weird things.  I haven't figured out
%why, but there's no reason to set \topskip to 0pt, so this is not
%considered a bug.  (Discovered by Mabry Tyson.)
%

% One more test to check the headings 

%%%% Why has  page 6 a header made according to MYHEADINGS?
%Previous page set the header back to HEADINGS!

%105. A line break can occur at a space in a `verbatim' environment.
%(Reported by Nelson Beebe, corrected 19 Nov 86.)
%

%\settowidth{\hyphenbox}{\tt Can a line break occur at a space}
%
%\parbox{\hyphenbox}{%
%\verb|Can a line break occur at a space in a `verbatim' environment? In a|
%\verb|\parbox don't think the bug is corrected!|%
%}
% \verb is not supposed to work in the argument of any other command,
% so this is not a good test, let's rather switch to twocolumn.

\twocolumn

\bugid{105}

\verb|Can a  line break  occur at a space|

\verb| in a `verbatim' environment?|

{\tt  Can a  line break  occur at a s p a c e in a `verbatim' environment?}

Alles in ordnung!

\onecolumn

\tableofcontents 

\end{document}
