\ProvidesExplPackage {luamml-patches-array} {2024-10-30} {0.2.0}
  {Feel free to add a description here}

\lua_now:n { require'luamml-array' }

\str_if_exist:cF { l__socket_tagsupport/math/luamml/array/save_plug_str }
  {
     \NewSocket{tagsupport/math/luamml/array/save}{0}
     \NewSocket{tagsupport/math/luamml/array/finalize}{0}
     \NewSocket{tagsupport/math/luamml/array/initcol}{0}
     \NewSocket{tagsupport/math/luamml/array/savecol}{0}
     \NewSocket{tagsupport/math/luamml/array/finalizecol}{1}
     \AssignSocketPlug{tagsupport/math/luamml/array/finalizecol}{noop}
  }

\NewSocketPlug{tagsupport/math/luamml/array/save}{default}
 {
   \__luamml_array_save_array:
 }   

\NewSocketPlug{tagsupport/math/luamml/array/finalize}{default}
 {
   \mode_if_math:T { \__luamml_array_finalize_array: }
 }   
 
\NewSocketPlug{tagsupport/math/luamml/array/initcol}{default}
 {
   \__luamml_array_init_col: 
 }    

\NewSocketPlug{tagsupport/math/luamml/array/savecol}{default}
 {
   \luamml_save:nn {} {mtd}
 }    

\NewSocketPlug{tagsupport/math/luamml/array/finalizecol}{default}
 {
   \__luamml_array_finalize_col:w #1~
 } 
 
\AssignSocketPlug{tagsupport/math/luamml/array/save}{default}    
\AssignSocketPlug{tagsupport/math/luamml/array/finalize}{default}
\AssignSocketPlug{tagsupport/math/luamml/array/initcol}{default}
\AssignSocketPlug{tagsupport/math/luamml/array/savecol}{default}
\AssignSocketPlug{tagsupport/math/luamml/array/finalizecol}{default}
