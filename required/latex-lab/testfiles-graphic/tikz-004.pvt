% !Mode:: "TeX:UTF-8:Main"
\ExplSyntaxOn
\debug_on:n { check-declarations , deprecation }
\ExplSyntaxOff
\DocumentMetadata{uncompress,testphase=phase-III,testphase=tikz,pdfversion=1.7}
\input{regression-test}
\documentclass{article}
\usepackage{tikz}
\begin{document}
% this tests text mode where nodes are minipage and picture is in a marginpar.
% The text inside the nodes should be visible and be tagged like a minipage
\START 

\tagpdfsetup{graphic/tagging=text}
\marginpar{
\begin{tikzpicture}[alt=red line]
\draw[red] (0,0)--(1,1);
\node[draw,text width=1cm]{blub};
\end{tikzpicture}}

\marginpar{\begin{tikzpicture}[alt=red line]
\draw[red] (0,0)--(1,1);
\node[draw,text width=1cm]{blub};
\end{tikzpicture}
xxxx}

\marginpar{xxxx
\begin{tikzpicture}[alt=red line]
\draw[red] (0,0)--(1,1);
\node[draw,text width=1cm]{blub};
\end{tikzpicture}}

\marginpar{xxxx
\begin{tikzpicture}
\draw[red] (0,0)--(1,1);
\node[draw,text width=1cm]{blub};
\end{tikzpicture}
xxxx}

\end{document}
