\DocumentMetadata{ testphase = { phase-III, math }}
  
\documentclass{article}

\input{regression-test}


\ExplSyntaxOn
\makeatletter
\cs_set_protected:Npn \__math_tag_dollardollar_display_end:
  {
    %  \typeout{== tag dollarldollar display end}
    %  \ShowTagging{struct-stack}
    \para_raw_end:
    \tagpdfparaOn
    \l__math_tmpa_skip \lastskip
    \tag_socket_use:n{math/display/formula/end}
    \nobreak
    \skip_vertical:n { -\l__math_tmpa_skip } % remove the negative belowdisplayskip
    \penalty \postdisplaypenalty
    \skip_vertical:n { -\l__math_tmpa_skip } % insert the correct skip
  \@doendpe
  {\parskip\z@\noindent}
  \ignorespaces
}
\makeatother
\ExplSyntaxOff

\parskip=77pt

\begin{document}
\START
Some Text
$$A$$           % not really supported but ...
%
More

WWW
$$B$$

XXX

\showoutput

abc
\begin{itemize}
\item A
\end{itemize}
def
\begin{itemize}
\item B
\end{itemize}

xyz

\newpage
\OMIT
\end{document}
